<!DOCTYPE html>
<html lang="vi">

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Hồ sơ</title>
        <script src="https://cdn.tailwindcss.com"></script>
        <script src="/accounts/js/profile.js"></script>
</head>

<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">
        <div class="w-full max-w-4xl bg-white rounded-lg shadow-lg p-6 relative">
                <!-- User Avatar in Top-Right Corner -->
                <img id="top-avatar" th:src="@{/avatar/{id}(id=${user.id})}" alt="Avatar"
                        class="absolute top-4 right-4 w-16 h-16 rounded-full object-cover border-2 border-gray-200">
                <h1 class="text-2xl font-bold text-gray-800 mb-6">Chào, <span th:text="${user.fullName}">Tên User</span></h1>

                <!-- Tab Navigation -->
                <div class="flex border-b border-gray-200 mb-6">
                        <button class="tab-button px-4 py-2 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600"
                                onclick="showTab('profile')">Hồ sơ</button>
                        <button class="tab-button px-4 py-2 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600"
                                onclick="showTab('edit')">Chỉnh sửa</button>
                        <button class="tab-button px-4 py-2 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600"
                                onclick="showTab('avatar')">Ảnh đại diện</button>
                        <button class="tab-button px-4 py-2 text-sm font-medium text-gray-600 hover:text-blue-600 border-b-2 border-transparent hover:border-blue-600"
                                onclick="showTab('notifications')">Thông báo</button>
                </div>

                <!-- Profile Tab -->
                <div id="profile" class="tab-content">
                        <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                                <div>
                                        <h2 class="text-lg font-semibold text-gray-700 mb-4">Thông tin cá nhân</h2>
                                        <p><strong>Email:</strong> <span class="text-gray-600" th:text="${user.email}"></span></p>
                                        <p><strong>Phone:</strong> <span class="text-gray-600" th:text="${user.phone}"></span></p>
                                        <p><strong>Bio:</strong> <span class="text-gray-600" th:text="${user.bio}"></span></p>
                                </div>
                                <div th:if="${role == 'mentor'}">
                                        <h2 class="text-lg font-semibold text-gray-700 mb-4">Thông tin Mentor</h2>
                                        <p><strong>Chuyên môn:</strong> <span class="text-gray-600 max-w-full break-words"
                                                        th:text="${mentor.expertise}"></span></p>
                                        <p><strong>Tổng số buổi dạy:</strong> <span class="text-gray-600" th:text="${mentor.totalSessions}"></span></p>
                                        <p><strong>Đánh giá:</strong> <span class="text-gray-600" th:text="${mentor.rating}"></span></p>
                                        <p class="mt-4">
                                                <span th:if="${mentor != null and mentor.isAvailable}" class="text-green-600">✅ Bạn đang dạy</span>
                                                <span th:unless="${mentor != null and mentor.isAvailable}" class="text-red-600">❌ Bạn đang không có buổi
                                                        dạy nào</span>
                                        </p>
                                </div>
                                <div th:if="${role == 'mentee'}">
                                        <h2 class="text-lg font-semibold text-gray-700 mb-4">Thông tin Mentee</h2>
                                        <p><strong>Sở thích:</strong> <span class="text-gray-600 max-w-full break-words"
                                                        th:text="${mentee.interests}"></span></p>
                                        <p><strong>Số buổi học:</strong> <span class="text-gray-600" th:text="${mentee.totalSessions}"></span></p>                              
                                </div>
                        </div>
                </div>

                <!-- Edit Tab -->
                <div id="edit" class="tab-content hidden">
                        <form th:action="@{/profile/{id}/edit(id=${user.id})}" method="post" class="space-y-4">
                                <input type="text" name="id" th:value="${user.id}" hidden>
                                <div>
                                        <label class="block text-sm font-medium text-gray-700">Họ tên:</label>
                                        <input type="text" name="fullName" th:value="${user.fullName}" required
                                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50">
                                </div>
                                <div>
                                        <label class="block text-sm font-medium text-gray-700">Email:</label>
                                        <input type="email" name="email" th:value="${user.email}" required
                                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50">
                                </div>
                                <div>
                                        <label class="block text-sm font-medium text-gray-700">Điện Thoại:</label>
                                        <input type="text" name="phone" th:value="${user.phone}"
                                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50">
                                </div>
                                <div>
                                        <label class="block text-sm font-medium text-gray-700">Bio:</label>
                                        <textarea name="bio" th:text="${user.bio}"
                                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50">
                                        </textarea>
                                </div>
                                <div th:if="${role == 'mentor'}">
                                        <label class="block text-sm font-medium text-gray-700">Chuyên môn:</label>
                                        <textarea name="expertise" th:text="${mentor.expertise}"
                                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50">
                                        </textarea>
                                </div>
                                <div th:if="${role == 'mentee'}">
                                        <label class="block text-sm font-medium text-gray-700">Sở thích:</label>
                                        <textarea name="interests" th:text="${mentee.interests}"
                                                class="mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-blue-500 focus:ring focus:ring-blue-500 focus:ring-opacity-50">
                                        </textarea>
                                </div>
                                <button type="submit"
                                        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Lưu thông
                                        tin</button>
                        </form>
                </div>

                <!-- Avatar Tab -->
                <div id="avatar" class="tab-content hidden">
                        <form th:action="@{/upload/{id}(id=${user.id})}" method="post" enctype="multipart/form-data" class="flex flex-col items-center space-y-4">
                                <img id="avatar-preview" th:src="@{/avatar/{id}(id=${user.id})}" alt="Avatar"
                                        class="w-32 h-32 rounded-full object-cover border-2 border-gray-200">
                                <input type="file" id="avatar-input" name="image" accept="image/*" class="mt-2 text-sm text-gray-600" required>
                                <button type="submit" class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Cập nhật
                                        ảnh</button>         
                                </form>
                </div>

                <!-- Notifications Tab -->
                <div id="notifications" class="tab-content hidden">
                        <form class="space-y-4">
                                <div class="flex items-center">
                                        <input type="checkbox" id="email-notifications"
                                                class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label for="email-notifications" class="ml-2 text-sm text-gray-700">Nhận thông
                                                báo qua Email</label>
                                </div>
                                <div class="flex items-center">
                                        <input type="checkbox" id="app-notifications"
                                                class="h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded">
                                        <label for="app-notifications" class="ml-2 text-sm text-gray-700">Nhận thông báo
                                                qua Ứng dụng</label>
                                </div>
                                <button type="submit"
                                        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Lưu cài
                                        đặt</button>
                        </form>
                </div>
        </div>
        <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
        <script th:if="${error}">
                Swal.fire({
                        icon: 'error',
                        title: 'Lỗi',
                        text: '[[${error}]]'
                });
        </script>

</body>

</html>