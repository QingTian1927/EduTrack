<!DOCTYPE html>
<html lang="vi" xmlns:th="http://www.thymeleaf.org">

<head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>System Dashboard - Manager</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet">
        <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <link rel="stylesheet" href="/accounts/css/stats.css">
</head>

<body>
        <div class="container-fluid">
                <!-- Header Section -->
                <div class="header-section animate-fade-in">
                        <h1><i class="fas fa-chart-line"></i>System Dashboard</h1>
                        <p class="lead">Manage and monitor the whole system performance</p>
                </div>

                <!-- Period Selector -->
                <div class="period-selector animate-fade-in">
                        <button class="btn period-btn" th:classappend="${currentPeriod == 'week'} ? 'active' : ''"
                                onclick="changePeriod('week')">
                                <span>7 days</span>
                        </button>
                        <button class="btn period-btn" th:classappend="${currentPeriod == 'month'} ? 'active' : ''"
                                onclick="changePeriod('month')">
                                <span>30 days</span>
                        </button>
                        <button class="btn period-btn" th:classappend="${currentPeriod == 'quarter'} ? 'active' : ''"
                                onclick="changePeriod('quarter')">
                                <span>3 months</span>
                        </button>
                        <button class="btn period-btn" th:classappend="${currentPeriod == 'year'} ? 'active' : ''"
                                onclick="changePeriod('year')">
                                <span>1 year</span>
                        </button>
                </div>

                <!-- Main Stats Cards -->
                <div class="row">
                        <div class="col-md-3">
                                <div class="stats-card animate-fade-in">
                                        <h5><i class="fas fa-money-bill-wave"></i> Total revenue of the system</h5>
                                        <h2 id="totalRevenue"
                                                th:text="${#numbers.formatDecimal(stats.totalRevenue, 0, 'COMMA', 0, 'POINT')} + '₫'">
                                                2,450,000,000₫</h2>
                                        <span class="growth-positive" id="revenueGrowth"
                                                th:text="'+' + ${#numbers.formatDecimal(stats.revenueGrowth, 1, 'COMMA', 1, 'POINT')} + '% compared to the previous month'">+15.2%
                                                compared to the previous month</span>
                                </div>
                        </div>
                        <div class="col-md-3">
                                <div class="stats-card animate-fade-in">
                                        <h5><i class="fas fa-chalkboard-teacher"></i> Total mentor</h5>
                                        <h2 id="totalMentors" th:text="${stats.totalMentors}">145</h2>
                                        <span class="growth-positive" id="mentorGrowth"
                                                th:text="'+' + ${stats.mentorGrowth} + ' new mentor'">+12 new mentor
                                                </span>
                                </div>
                        </div>
                        <div class="col-md-3">
                                <div class="stats-card animate-fade-in">
                                        <h5><i class="fas fa-users"></i> Total student</h5>
                                        <h2 id="totalStudents"
                                                th:text="${#numbers.formatDecimal(stats.totalStudents, 0, 'COMMA', 0, 'POINT')}">
                                                3,247</h2>
                                        <span class="growth-positive" id="studentGrowth"
                                                th:text="'+' + ${stats.studentGrowth} + ' student'">+156 student</span>
                                </div>
                        </div>
                </div>

                <!-- System Overview -->
                <div class="section-header">
                        <h3><i class="fas fa-chart-bar"></i> System overview</h3>
                </div>

                <div class="row">
                        <div class="col-md-2">
                                <div class="overview-card">
                                        <h4 id="activeCourses"
                                                th:text="${#numbers.formatDecimal(stats.activeCourses, 0, 'COMMA', 0, 'POINT')}">
                                                1,234</h4>
                                        <p>Active course</p>
                                </div>
                        </div>
                        <div class="col-md-2">
                                <div class="overview-card">
                                        <h4 id="satisfactionRate" th:text="${stats.satisfactionRate} + '%'">94%</h4>
                                        <p>Satisfaction Rate</p>
                                </div>
                        </div>
                        <div class="col-md-2">
                                <div class="overview-card">
                                        <h4 id="avgRevenuePerMentor"
                                                th:text="${#numbers.formatDecimal(stats.avgRevenuePerMentor/1000000, 1, 'COMMA', 1, 'POINT')} + 'M₫'">
                                                16.9M₫</h4>
                                        <p>Average revenue per Mentor</p>
                                </div>
                        </div>
                        <div class="col-md-2">
                                <div class="overview-card">
                                        <h4 id="avgStudentsPerMentor" th:text="${stats.avgStudentsPerMentor}">22</h4>
                                        <p>Average student per Mentor</p>
                                </div>
                        </div>
                        <div class="col-md-2">
                                <div class="overview-card">
                                        <h4 id="avgRating" th:text="${stats.avgRating} + '⭐'">4.8⭐</h4>
                                        <p>Average Rating</p>
                                </div>
                        </div>
                </div>

                <!-- Charts Section -->
                <div class="row mt-4">
                        <div class="col-md-8">
                                <div class="card">
                                        <div class="card-header">
                                                <h5><i class="fas fa-chart-line"></i> System revenue over time
                                                </h5>
                                        </div>
                                        <div class="card-body">
                                                <div class="chart-container">
                                                        <canvas id="revenueChart"></canvas>
                                                </div>
                                        </div>
                                </div>
                        </div>
                        <div class="col-md-4">
                                <div class="card">
                                        <div class="card-header">
                                                <h5><i class="fas fa-trophy"></i> Top 5 mentor according to revenue</h5>
                                        </div>
                                        <div class="card-body">
                                                <div id="topMentorsList">
                                                        <div class="mentor-item"
                                                                th:each="mentor, iterStat : ${stats.topMentors}">
                                                                <div class="d-flex align-items-center">
                                                                        <span class="badge bg-primary"
                                                                                th:text="${iterStat.count}">1</span>
                                                                        <span th:text="${mentor.mentorName}">Nguyễn Văn
                                                                                A</span>
                                                                </div>
                                                                <strong
                                                                        th:text="${mentor.formattedRevenue}">45,000,000₫</strong>
                                                        </div>
                                                </div>
                                        </div>
                                </div>
                        </div>
                </div>
        </div>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/js/bootstrap.bundle.min.js"></script>
        <script src="/accounts/js/stats.js"></script>
</body>

</html>