<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">

<head>
        <meta charset="UTF-8">
        <title>Scheduled Jobs Management</title>
        <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="bg-gray-100 flex">
        <!-- Sidebar -->
        <div class="w-64 bg-gray-800 text-white h-screen fixed">
                <div class="p-6 text-xl font-bold">EduTrack Admin</div>
                <nav class="mt-4">
                        <a href="/admin/dashboard" class="block py-2 px-4 hover:bg-gray-700">Dashboard</a>
                        <a href="/admin/users" class="block py-2 px-4 hover:bg-gray-700">User Management</a>
                        <a href="/admin/system-settings" class="block py-2 px-4 hover:bg-gray-700 ">System
                                Settings</a>
                        <a href="/admin/jobs" class="block py-2 px-4 bg-gray-700 text-white">ScheduledJobs</a>
                </nav>
        </div>
        <div class="ml-64 flex-1 p-6">
                <h1 class="text-2xl font-bold mb-6">Scheduled Jobs Management</h1>
                
                <!-- Filter -->
                <form method="get" class="mb-4 flex gap-2">
                        <input type="text" name="search" th:value="${search}" placeholder="Search jobs..."
                                class="border p-2 rounded w-1/3">
                        <button class="bg-blue-500 text-white px-4 py-2 rounded hover:bg-blue-600">Search</button>
                </form>
                
                <!-- Job Table -->
                <div class="bg-white shadow rounded p-4">
                        <table class="min-w-full text-sm">
                                <thead>
                                        <tr class="bg-gray-100">
                                                <th class="text-left px-3 py-2">Name</th>
                                                <th class="text-left px-3 py-2">Cron</th>
                                                <th class="text-left px-3 py-2">Description</th>
                                                <th class="text-left px-3 py-2">Status</th>
                                                <th class="text-left px-3 py-2">Last Run</th>
                                                <th class="text-left px-3 py-2">Actions</th>
                                        </tr>
                                </thead>
                                <tbody>
                                        <tr th:each="job : ${jobs}" class="border-t hover:bg-gray-50">
                                                <td class="px-3 py-2" th:text="${job.name}"></td>
                                                <td class="px-3 py-2" th:text="${job.cronExpression}"></td>
                                                <td class="px-3 py-2" th:text="${job.description}"></td>
                                                <td class="px-3 py-2">
                                                        <span th:text="${job.active} ? 'Active' : 'Disabled'"
                                                                th:classappend="${job.active} ? 'text-green-600' : 'text-red-600'"></span>
                                                </td>
                                                <td class="px-3 py-2" th:text="${job.lastRunTime}"></td>
                                                <td class="px-3 py-2 space-x-2">
                                                        <form th:action="@{'/admin/jobs/' + ${job.id} + '/run'}" method="post"
                                                                class="inline">
                                                                <button class="bg-green-500 text-white px-2 py-1 rounded text-xs">Run
                                                                        Now</button>
                                                        </form>
                                                        <form th:action="@{'/admin/jobs/' + ${job.id} + '/toggle'}" method="post"
                                                                class="inline">
                                                                <input type="hidden" name="active" th:value="${!job.active}" />
                                                                <button class="bg-yellow-500 text-white px-2 py-1 rounded text-xs"
                                                                        th:text="${job.active} ? 'Disable' : 'Enable'"></button>
                                                        </form>
                                                        <form th:action="@{'/admin/jobs/' + ${job.id} + '/update'}" method="post"
                                                                class="inline">
                                                                <input type="text" name="cronExpression"
                                                                        th:value="${job.cronExpression}"
                                                                        class="border p-1 text-xs w-32" />
                                                                <button
                                                                        class="bg-blue-500 text-white px-2 py-1 rounded text-xs">Update</button>
                                                        </form>
                                                </td>
                                        </tr>
                                </tbody>
                        </table>
                </div>
        </div>
        
</body>

</html>